{
  "body_html": "\n\n  \n    一、rsync协议收集数据\n    \n    \n    \n    \n    \n  <link href=\"https://www.yuque.com/attachments/yuque/0/2020/css/491128/1588213910235-976bcd3a-7a9c-473d-b800-1b1df54807d4.css\" rel=\"stylesheet\" type=\"text/css\" />\n<link href=\"https://www.yuque.com/attachments/yuque/0/2020/css/491128/1588213910286-64db0dd0-ac29-46fb-9241-76ef318b1b53.css\" rel=\"stylesheet\" type=\"text/css\" />\n\n  \n        \n<div class=\"page\">\n    \n        <h1 class=\"book-chapter\" id=\"calibre_toc_23\">一、rsync协议收集数据</h1>\n        <div class=\"section\">\n            <h1 id=\"一、rsync协议收集数据\" class=\"calibre7\">一、rsync协议收集数据</h1>\n<h2 id=\"1、处理ssh免登\" class=\"calibre8\">1、处理ssh免登</h2>\n<p class=\"calibre12\">A、B两台服务器，要实现服务器B不用密码直接登录到A服务器上，需要如下操作</p>\n<h3 id=\"11、在b服务器执行命名生成密钥\" class=\"calibre9\">1.1、在B服务器执行命名生成密钥</h3>\n<pre class=\"calibre10\"><code class=\"pcalibre4 pcalibre3 calibre11\">ssh-keygen -t rsa\n</code></pre><p class=\"calibre12\">同时会在B服务器创建成~/.ssh文件夹，生成的公钥文件和私钥文件就保存在这里。</p>\n<pre class=\"calibre10\"><code class=\"pcalibre4 pcalibre3 calibre11\">[xxxx@t0-xxxxxxx-txxx03 .ssh]# pwd\n/root/.ssh\n[xxxx@t0-xxxx-tdas03 .ssh]# ll\ntotal 8\n-rw------- 1 root root 887 Aug  1 16:57 id_rsa\n-rw-r--r-- 1 root root 237 Aug  1 16:57 id_rsa.pub\n</code></pre><h3 id=\"12、查看a服务器的ssh目录\" class=\"calibre9\">1.2、查看A服务器的.ssh目录</h3>\n<p class=\"calibre12\">查看A服务器准备免登录账号对应的“~/”目录下，是否有“.ssh”文件夹，如果没用使用“ssh-keygen”命令创建。</p>\n<h3 id=\"13、将b的公钥同步到a服务器\" class=\"calibre9\">1.3、将B的公钥同步到A服务器</h3>\n<pre class=\"calibre10\"><code class=\"pcalibre4 pcalibre3 calibre11\">ssh-copy-id -i ~/.ssh/id_rsa.pub ftpuser@10.xxx.xxx.4\n</code></pre><p class=\"calibre12\">通过该命令B服务器的公钥会追到A服务器的ftpuser账号的 .ssh/authorized_keys文件里。</p>\n<pre class=\"calibre10\"><code class=\"pcalibre4 pcalibre3 calibre11\">[ftpxxxx@t0-xxxxxx-tdxx01 .ssh]$ cat authorized_keys \nssh-rsa \nxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\nxxx@t0-xxxx-tdxx02\nssh-rsa xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx== xxxx@t0-xxxxx-tdas03\n</code></pre><p class=\"calibre12\">注：直接将对应的公钥证书文件id_rsa.pub的内容拷贝到.ssh/authorized_keys也可以达到相同的效果。</p>\n<h3 id=\"14、b服务器修可以免密码直接登录a服务器了\" class=\"calibre9\">1.4、B服务器修可以免密码直接登录A服务器了</h3>\n<pre class=\"calibre10\"><code class=\"pcalibre4 pcalibre3 calibre11\">[xxx@t0-xxxxx-tdas03 .ssh]# ssh ftpxxxx@10.xxx.xxx.4\nWarning: Permanently added '10.xxx.xxx.4' (ECDSA) to the list of known hosts.\nLast login: Mon Aug  1 16:56:58 2016 from 10.xxx.xxx.5\n[ftpxxxx@t0-xxxxxxxx-tdxx01 ~]$ ls\nanbc  ping.sh  shterm_log  test\n</code></pre><h2 id=\"2、实现文件同步\" class=\"calibre13\">2、实现文件同步</h2>\n<p class=\"calibre12\">参考资料\n<a href=\"http:_www.jb51.net_article_60192\" target=\"_blank\" class=\"pcalibre pcalibre2 pcalibre1 calibre20\">http://www.jb51.net/article/60192.htm</a></p>\n<p class=\"calibre12\">使用指定证书登录：</p>\n<pre class=\"calibre10\"><code class=\"pcalibre4 pcalibre3 calibre11\">rsync -avR -e \"ssh -i /home/anbc/.ssh/id_rsa\" /home/anbc/anbc_test  ftpuser@10.130.203.4:/home/ftpuser/test\n</code></pre>\n        </div>\n    \n</div>\n\n        \n    \n\n\n\n",
  "slug": 6588808,
  "title": "1rsyncxie_yi_shou_ji_shu_ju"
}