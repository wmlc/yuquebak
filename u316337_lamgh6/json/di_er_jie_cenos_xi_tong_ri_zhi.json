{
  "body_html": "\n\n  \n    第二节 Cenos系统日志\n    \n    \n    \n    \n    \n  <link href=\"https://www.yuque.com/attachments/yuque/0/2020/css/491128/1588213910235-976bcd3a-7a9c-473d-b800-1b1df54807d4.css\" rel=\"stylesheet\" type=\"text/css\" />\n<link href=\"https://www.yuque.com/attachments/yuque/0/2020/css/491128/1588213910286-64db0dd0-ac29-46fb-9241-76ef318b1b53.css\" rel=\"stylesheet\" type=\"text/css\" />\n\n  \n        \n<div class=\"page\">\n    \n        <h1 class=\"book-chapter\" id=\"calibre_toc_53\">第二节 Cenos系统日志</h1>\n        <div class=\"section\">\n            <h1 id=\"第二节-cenos系统日志\" class=\"calibre7\">第二节 Cenos系统日志</h1>\n<p class=\"calibre12\">《深度解析CentOS通过日志反查入侵》\n<a href=\"http:_www.centoscn.com_centossecurity_centossafe_2014_0304_2490\" target=\"_blank\" class=\"pcalibre pcalibre2 pcalibre1 calibre20\">http://www.centoscn.com/CentosSecurity/CentosSafe/2014/0304/2490.html</a></p>\n<p class=\"calibre12\">登录日志grok</p>\n<h2 id=\"1、secure日志，ssh登录成功日志解析\" class=\"calibre13\">1、secure日志，ssh登录成功日志解析</h2>\n<pre class=\"calibre10\"><code class=\"pcalibre4 pcalibre3 calibre11\">Aug 31 01:45:17 localhost sshd[9995]: Accepted password for root from 10.136.122.52 port 63715 ssh2\nSep  6 15:40:43 t0-security-tdas02 sshd[11937]: Accepted password for root from 10.135.52.138 port 37421 ssh2\n\n%{SYSLOGTIMESTAMP:my_datatime} %{WORD:local_host} %{WORD:title}\\[%{INT:pid}\\]: Accepted password for %{WORD:user} from %{IP:from_ip} .* %{INT:from_port} %{WORD:ssh_num}\n\n{\"my_datatime\"=&gt;[\"Aug 31 01:45:17\"], \"MONTH\"=&gt;[\"Aug\"], \"MONTHDAY\"=&gt;[\"31\"], \"TIME\"=&gt;[\"01:45:17\"], \"HOUR\"=&gt;[\"01\"], \"MINUTE\"=&gt;[\"45\"], \"SECOND\"=&gt;[\"17\"], \"local_host\"=&gt;[\"localhost\"], \"title\"=&gt;[\"sshd\"], \"pid\"=&gt;[\"9995\"], \"user\"=&gt;[\"root\"], \"from_ip\"=&gt;[\"10.136.122.52\"], \"IPV6\"=&gt;[nil], \"IPV4\"=&gt;[\"10.136.122.52\"], \"from_port\"=&gt;[\"63715\"], \"ssh_num\"=&gt;[\"ssh2\"]}\n</code></pre><h3 id=\"2、secure日志，ssh登录失败日志解析\" class=\"calibre9\">2、secure日志，ssh登录失败日志解析</h3>\n<pre class=\"calibre10\"><code class=\"pcalibre4 pcalibre3 calibre11\">Aug 31 01:43:58 localhost sshd[9995]: Failed password for root from 10.136.122.52 port 63715 ssh2\nAug 31 02:57:49 localhost sshd[10371]: Failed password for anbc from 10.136.122.52 port 65514 ssh2\n\n\n%{SYSLOGTIMESTAMP:datatime} %{WORD:host} %{WORD:title}\\[%{INT:pid}\\]: Failed password for %{WORD:user} from %{IP:ip} .* %{INT:port} %{WORD:ssh_num}\n\n{\"datatime\"=&gt;[\"Aug 31 01:43:58\"], \"MONTH\"=&gt;[\"Aug\"], \"MONTHDAY\"=&gt;[\"31\"], \"TIME\"=&gt;[\"01:43:58\"], \"HOUR\"=&gt;[\"01\"], \"MINUTE\"=&gt;[\"43\"], \"SECOND\"=&gt;[\"58\"], \"host\"=&gt;[\"localhost\"], \"title\"=&gt;[\"sshd\"], \"pid\"=&gt;[\"9995\"], \"user\"=&gt;[\"root\"], \"ip\"=&gt;[\"10.136.122.52\"], \"IPV6\"=&gt;[nil], \"IPV4\"=&gt;[\"10.136.122.52\"], \"port\"=&gt;[\"63715\"], \"ssh_num\"=&gt;[\"ssh2\"]}\n</code></pre><h2 id=\"3、secure日志，ssh登录退出日志解析\" class=\"calibre13\">3、secure日志，ssh登录退出日志解析</h2>\n<pre class=\"calibre10\"><code class=\"pcalibre4 pcalibre3 calibre11\">Aug 31 03:02:35 localhost sshd[10417]: Received disconnect from 10.136.122.52: 11: disconnected by user\nSep  6 15:41:09 t0-security-tdas02 sshd[11937]: Received disconnect from 10.135.52.138: 11: disconnected by user\n\n%{SYSLOGTIMESTAMP:datatime} %{WORD:local_host} %{WORD:title}\\[%{INT:pid}\\]: Received disconnect from %{IP:from_ip}\n\n{\"datatime\"=&gt;[\"Aug 31 03:02:35\"], \"MONTH\"=&gt;[\"Aug\"], \"MONTHDAY\"=&gt;[\"31\"], \"TIME\"=&gt;[\"03:02:35\"], \"HOUR\"=&gt;[\"03\"], \"MINUTE\"=&gt;[\"02\"], \"SECOND\"=&gt;[\"35\"], \"local_host\"=&gt;[\"localhost\"], \"title\"=&gt;[\"sshd\"], \"pid\"=&gt;[\"10417\"], \"from_ip\"=&gt;[\"10.136.122.52\"], \"IPV6\"=&gt;[nil], \"IPV4\"=&gt;[\"10.136.122.52\"]}\n</code></pre>\n        </div>\n    \n</div>\n\n        \n    \n\n\n\n",
  "slug": 6588848,
  "title": "di_er_jie_cenos_xi_tong_ri_zhi"
}