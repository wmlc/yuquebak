{
  "body_html": "\n\n  \n    第三节 加载数据\n    \n    \n    \n    \n    \n  <link href=\"https://www.yuque.com/attachments/yuque/0/2020/css/491128/1588213910235-976bcd3a-7a9c-473d-b800-1b1df54807d4.css\" rel=\"stylesheet\" type=\"text/css\" />\n<link href=\"https://www.yuque.com/attachments/yuque/0/2020/css/491128/1588213910286-64db0dd0-ac29-46fb-9241-76ef318b1b53.css\" rel=\"stylesheet\" type=\"text/css\" />\n\n  \n        \n<div class=\"page\">\n    \n        <h1 class=\"book-chapter\" id=\"calibre_toc_42\">第三节 加载数据</h1>\n        <div class=\"section\">\n            <blockquote class=\"calibre32\">\n</blockquote>\n<h1 id=\"第三节-加载数据\" class=\"calibre7\">第三节 加载数据</h1>\n<h2 id=\"1、向elasticsearch中导入数据\" class=\"calibre8\">1、向Elasticsearch中导入数据</h2>\n<p class=\"calibre12\">具体方法详见：《Getting Started with Kibana》</p>\n<h2 id=\"2、在kibana操作elasticsearch中的数据\" class=\"calibre13\">2、在Kibana操作Elasticsearch中的数据</h2>\n<h3 id=\"21、加载elasticsearch中的索引\" class=\"calibre9\">2.1、加载Elasticsearch中的索引</h3>\n<p class=\"calibre12\"><strong class=\"calibre16\">启动kibana系统，访问<a href=\"http://127.0.0.1:5601\" target=\"_blank\" class=\"pcalibre pcalibre2 pcalibre1 calibre20\">http://127.0.0.1:5601</a>, 点击Settings-&gt;Indices-&gt;Add New</strong></p>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213922500-541872d4-6648-432d-babe-cbb63f10fdb6.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\"><strong class=\"calibre16\">导入索引：</strong></p>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">取消“Index contains time-based events”选项。</li>\n<li class=\"calibre18\">在Index name or pattern 中输入“ba*”。</li>\n<li class=\"calibre18\">点击“Create”按钮，将符合“ba*”正则的索引导入到kibana中来。</li>\n</ul>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213922567-60d27119-bbf7-4429-b6a8-759291b106dc.png\" class=\"calibre14\" /></p>\n<h3 id=\"22、删除导入的索引\" class=\"calibre9\">2.2、删除导入的索引</h3>\n<p class=\"calibre12\">选中删除的索引，点击删除按钮</p>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213922607-57d47a76-2c53-4027-a6c6-476de167b2e0.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\">有删除按钮并列的几个按钮分别是：</p>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">set as default index</li>\n<li class=\"calibre18\">refresh field list</li>\n<li class=\"calibre18\">remove index pattern</li>\n</ul>\n<h3 id=\"23、加载elasticsearch中包含时间序列的索引\" class=\"calibre9\">2.3、加载Elasticsearch中包含时间序列的索引</h3>\n<p class=\"calibre12\">加载logstash* 索引</p>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213922644-0aa1d281-91dd-4250-84fc-d775a71548f8.png\" class=\"calibre14\" /></p>\n<h2 id=\"3、discover菜单使用\" class=\"calibre13\">3、Discover菜单使用</h2>\n<h3 id=\"31、查看数据\" class=\"calibre9\">3.1、查看数据</h3>\n<p class=\"calibre12\">点击“Discover”菜单，在下拉列表中选择“ba*”</p>\n<p class=\"calibre12\">查询框中默认值是“*”，表示查询所有数据</p>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213922684-434cf043-23de-465f-a331-3bb6ff003bc6.png\" class=\"calibre14\" /></p>\n<h3 id=\"32、条件查询\" class=\"calibre9\">3.2、条件查询</h3>\n<p class=\"calibre12\">在输入框中输入查询条件 <code class=\"pcalibre5 pcalibre6 calibre19\">account_number:&lt;100 AND balance:&gt;47500</code> 展示具体的查询结果。</p>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213922737-f70c47f3-9e18-4d83-a42f-0af40a7af18a.png\" class=\"calibre14\" /></p>\n<h3 id=\"33、只展示指定列的信息\" class=\"calibre9\">3.3、只展示指定列的信息</h3>\n<p class=\"calibre12\">将鼠标移动到左侧列表栏中展示的列名称上，列名称后会出现一个“add”按钮，点击“add”按钮，选中展示该列的信息。\n此时左侧列表中增加“Selected Fields”信息，包含了选中的列名称。</p>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213922796-727f73f8-5848-482d-a700-da05cd717838.png\" class=\"calibre14\" /></p>\n<h3 id=\"34、保存当前搜索模式\" class=\"calibre9\">3.4、保存当前搜索模式</h3>\n<p class=\"calibre12\">当确定一种查询模式后，想把这种模式保存下来，可以采用如下方法：</p>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">完成查询工作</li>\n<li class=\"calibre18\">点击“save search”按钮，弹出“保存信息栏”</li>\n<li class=\"calibre18\">在保存信息栏中给本次保存的搜索模式命名。</li>\n<li class=\"calibre18\">点击“save”按钮，保存工作完成。</li>\n</ul>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213922835-aaed1ae6-6cd5-4ad9-8cd5-fd3aa17d6aa3.png\" class=\"calibre14\" /></p>\n<h3 id=\"35、打开已有的保存模式\" class=\"calibre9\">3.5、打开已有的保存模式</h3>\n<p class=\"calibre12\">采用以下方式打开：</p>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">点击“load saved search” 按钮，弹出“打开信息栏”。</li>\n<li class=\"calibre18\">在下拉列表中选择要打开的搜索模式，当前准备打开的搜索模式是“my_search_table”。</li>\n</ul>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213922880-53b7d7a7-22e0-459c-a86d-94ec589de2aa.png\" class=\"calibre14\" /></p>\n<h2 id=\"4、数据的可视化展示\" class=\"calibre13\">4、数据的可视化展示</h2>\n<p class=\"calibre12\">点击“Visualize”菜单，进入数据可视化操作页面。</p>\n<h3 id=\"41、创建饼图（pie-chart）\" class=\"calibre9\">4.1、创建饼图（Pie chart）</h3>\n<h4 id=\"（1）、点击pie-chart图标，从step1进入到step2\" class=\"calibre15\">（1）、点击“Pie chart”图标，从”Step1“进入到“step2”</h4>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213922947-87d57d29-35f4-4ca0-8bcc-1d9c8aa33a44.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923003-a21ecdf1-224f-4b98-b325-59f75d0f2b4b.png\" class=\"calibre14\" /></p>\n<h4 id=\"（2）选择数据\" class=\"calibre15\">（2）选择数据</h4>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">点击“From a new search”</li>\n<li class=\"calibre18\">选择要加载的索引。这里选择“ba*”</li>\n</ul>\n<p class=\"calibre12\">出现如下页面：</p>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923058-5b9ca6ca-6dc1-4198-97f0-c49c554809be.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\">有两类聚合方式：</p>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">bucket aggregations</li>\n<li class=\"calibre18\">metric aggregations</li>\n</ul>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923109-b7bddbe9-b62f-4a29-9786-2fa9e8301cce.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\">在“Select buckets type”中点击“Split Slices”出现如下界面。\n在新的界面中的“Aggregation”项中选择“Range”。</p>\n<p class=\"calibre12\">”Aggregation“可选项包括：</p>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">Date Histogram</li>\n<li class=\"calibre18\">Histogram</li>\n<li class=\"calibre18\">Range</li>\n<li class=\"calibre18\">Date Range</li>\n<li class=\"calibre18\">IPv4 Range</li>\n<li class=\"calibre18\">Terms</li>\n<li class=\"calibre18\">Filters</li>\n<li class=\"calibre18\">Significant Terms</li>\n</ul>\n<p class=\"calibre12\">在“Field”选项中选择“balance”， 如图：</p>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923194-74f6863b-5472-45e7-b8a2-0f5cf0b9321d.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\">点击“Apply Changes”按钮后，展示出对应的饼图：\n<img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923249-1f25b0a1-317d-45a8-81b6-0148759815e9.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\">保存饼图查询模式</p>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">点击右上角“save visualization”按钮。</li>\n<li class=\"calibre18\">弹出保存信息页块。</li>\n<li class=\"calibre18\">在“Title”一栏中，为本次饼图查询模式命名。</li>\n<li class=\"calibre18\">点击“save” 按钮，保存饼图查询模式</li>\n</ul>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923324-578ae8cd-c5f7-4833-b588-f75de36ffb65.png\" class=\"calibre14\" /></p>\n<h3 id=\"42、使用sub-buckets创建饼图\" class=\"calibre9\">4.2、使用sub-buckets创建饼图</h3>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">在4.1创建饼图的基础上，点击左侧操作栏下部的“Add sub-buckets”按钮。</li>\n<li class=\"calibre18\">再次点击“Select buckets type”中“Split Slices”菜单。</li>\n<li class=\"calibre18\"></li>\n</ul>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923394-234fe121-e6e1-4a62-9806-085c7b231cb0.png\" class=\"calibre14\" /></p>\n<h3 id=\"43、绘制柱形图\" class=\"calibre9\">4.3、绘制柱形图</h3>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923469-cc9ed9d3-6c07-40c1-991d-429bef83d6fc.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\">如上图点击“Vertical bar chart”,选择“From a new search”后，增加了一个输入框，在输入框中输入索引名称“shakes*”，看到如图所示的页面。</p>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923529-5f64b54b-ddae-47b8-8f09-2edac69c22c8.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\">填写x轴和y轴的参数：</p>\n<p class=\"calibre12\">Y轴：</p>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">Aggregation:Unique Count</li>\n<li class=\"calibre18\">Field:speaker</li>\n</ul>\n<p class=\"calibre12\">X轴：</p>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">Aggregation：Terms</li>\n<li class=\"calibre18\">Field：play_name</li>\n<li class=\"calibre18\">Order By: metric:Unique count of speaker</li>\n<li class=\"calibre18\">Order:Ascending</li>\n<li class=\"calibre18\">Size:5\n<img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923573-639bda6c-dfb1-4ffb-a7b0-ea864582162c.png\" class=\"calibre14\" />\n点击\"三角”按钮，获得如下柱形图：\n<img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923617-4ab906ff-0453-4357-b3f1-2925c9557d4c.png\" class=\"calibre14\" /></li>\n</ul>\n<p class=\"calibre12\">注意到这里的角色名称是被看做一个整体的而没有被拆成多个单词，这是由于在开始导入数据做映射时，将“play_name”,字段设置成了“not analyze” 属性。</p>\n<h3 id=\"43、柱状图中增加其他维度信息\" class=\"calibre9\">4.3、柱状图中增加其他维度信息</h3>\n<p class=\"calibre12\">每个剧中，台词数量最多的角色的台词数量分别是多少。</p>\n<p class=\"calibre12\">（1）、在Y轴信息栏中点击“Add metrics”。\n（2）、增加了一项Y-Axis信息，对其进行如下设置：</p>\n<pre class=\"calibre10\"><code class=\"pcalibre4 pcalibre3 calibre11\">* Aggregation：MAX\n* Field:speech_number\n</code></pre><p class=\"calibre12\">（3）、点击“Apply change”按钮重新生成柱状图。</p>\n<p class=\"calibre12\">如图所示：\n<img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923662-25652c9d-2b19-47ba-8195-cd0c4da5ac74.png\" class=\"calibre14\" /></p>\n<h3 id=\"44、tile-map图\" class=\"calibre9\">4.4、Tile map图</h3>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923719-826aef69-2ad6-40b9-b168-71208c5fb974.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\">如上图所示进行以下操作：</p>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">在“Create a new visualization”中点击“Tile map”按钮。</li>\n<li class=\"calibre18\">选择“From a new search”选项，弹出输入框。</li>\n<li class=\"calibre18\">在输入框中输入索引名“logstash-*”</li>\n</ul>\n<p class=\"calibre12\">得到如图页面：\n<img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923792-100eb26d-3a6d-4107-8d9b-7f0bf544ff72.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\">选择时间：\n<img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923861-bbaaf4d3-0f48-42d8-abd5-f88def9d1f93.png\" class=\"calibre14\" /></p>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">点击屏幕右上角的时间选择器，即点击“Last 15 minutes”按钮，弹出一个子页面</li>\n<li class=\"calibre18\">在子页面左侧，选择“Absolute”按钮。出现日历列表。</li>\n<li class=\"calibre18\">选择对应的时间范围，这里选择从“2015-05-18 00:00:00.000”到“2015-05-20 23:59:59:999”范围。</li>\n<li class=\"calibre18\">点击“go”按钮确认时间设置</li>\n<li class=\"calibre18\">管理时间选项页面</li>\n</ul>\n<p class=\"calibre12\">设置完成后，时间范围发生变化，如图所示：\n<img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923895-a0d5e960-ab0d-4123-9f6a-6ddc34662639.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\">点击“Geo Coordinates”选项\n<img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213923935-0a5b944c-757f-49c5-aff9-e93ffe730de0.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\">添加如下信息：<img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213924006-c6052cd9-0e00-4e82-9f3c-d1af310c18c0.png\" class=\"calibre14\" /></p>\n<p class=\"calibre12\">点击“Apply Changes”按钮后，在地图上展示分布数据。</p>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213924087-53f07323-d16f-49da-a9f9-5649689c2076.png\" class=\"calibre14\" />\n在地图上可以做如下操作：</p>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">拖拽地图——移动地图的位置</li>\n<li class=\"calibre18\">点击地图——放大地图的指定位置</li>\n<li class=\"calibre18\">“加”、“减”——对地图进行放大缩小处理。</li>\n<li class=\"calibre18\">“Fit Data Bounds”按钮，用于快速调整地图到最合适的位置和缩放比例。</li>\n<li class=\"calibre18\">“Draw a rectangle”按钮，起到数据过滤的作用。点击该按钮后，可以用鼠标在地图上画一个矩形，可以选择显示矩形以外的数据或只显示矩形以内的数据。</li>\n</ul>\n<h3 id=\"45、标记小组件\" class=\"calibre9\">4.5、标记小组件</h3>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">点击“Markdown widget”选项，进入新的页面</li>\n</ul>\n<p class=\"calibre12\"><img alt src=\"https://cdn.nlark.com/yuque/0/2020/png/491128/1588213924171-04364eff-547b-41ba-9ceb-36dd9c1de442.png\" class=\"calibre14\" /></p>\n<ul class=\"calibre17\">\n<li class=\"calibre18\">输入以下文字:</li>\n</ul>\n<pre class=\"calibre10\"><code class=\"pcalibre4 pcalibre3 calibre11\">#This is a tutorial dashboard!\nThe Markdown widget uses **markdown** syntax.\n&gt; Blockquotes in Markdown use the &gt; character.\n</code></pre><ul class=\"calibre17\">\n<li class=\"calibre18\">保存展示模板，命名为“Markdown_1”。</li>\n</ul>\n\n        </div>\n    \n</div>\n\n        \n    \n\n\n\n",
  "slug": 6588869,
  "title": "di_san_jie_jia_zai_shu_ju"
}